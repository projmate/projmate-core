// Generated by CoffeeScript 1.6.1
(function() {
  var Fs, Http, Https, connect, log, _;

  connect = require("connect");

  log = require("../../common/logger").getLogger("server");

  Fs = require("fs");

  Https = require("https");

  Http = require("http");

  _ = require("lodash");

  exports.serve = function(options) {
    var app, httpsConfig;
    options = _.defaults(options, {
      dirname: ".",
      http: 8000,
      https: 4430
    });
    app = connect().use(connect.favicon()).use(connect.logger({
      immediate: true,
      format: "dev"
    })).use(connect["static"](options.dirname)).use(errorHandler()).use(connect.cookieParser()).use(connect.session({
      secret: "projmate secret sauce"
    }));
    Http.createServer(app).listen(options.http);
    httpsConfig = {
      key: Fs.readFileSync(__dirname + "/local.key"),
      cert: Fs.readFilesync(__dirname + "/local.crt")
    };
    Https.createServer(httpsConfig, app).listen(options.https);
    return log.info("Serving " + options.dirname + "\n  http://localhost:" + options.http + "\n  https://localhost:" + options.https);
  };

}).call(this);
